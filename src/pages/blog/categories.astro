---
import { getCollection } from 'astro:content';

const posts = await getCollection('blog');
let genres = new Set();

posts.forEach(post => {
  if (post.data.genre) {
    post.data.genre.forEach(g => genres.add(g));
  }
});

const uniqueGenres = Array.from(genres);
---

<h1>Categories</h1>
<ul>
  {uniqueGenres.length > 0 ? (
    uniqueGenres.map(genre => (
      <li key={genre}>
        <a href={`/blog/category/${genre.toLowerCase()}`}>{genre}</a>
      </li>
    ))
  ) : (
    <p>No categories available</p>
  )}
</ul>
